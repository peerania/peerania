#!/usr/bin/env bash
# Execute a commadn against a bitcoin node
set -e
#compile

PEERANHA_CONTRACT='peeranha'
PEERANHA_TOKEN_CONTRACT='peeranha.tkn'

PEERANHA_PATH='./src/contracts/peeranha'
PEERANHA_TOKEN_PATH='./src/contracts/peeranha.tkn'

UTILS_PATH='./src/contracts/utils/'

for i in "$@"
do
case $i in
    -d|--debug)
    DEBUG=1
    shift
    ;;
    *)
    echo "Error: Unrecognized option ${i%=*}"
    exit
    ;;
esac
done

if [ $DEBUG ]
then
    echo -e "\e[31mCompiling debug contract!!!\e[0m"
    #eosio-cpp -abigen -o $PEERANHA_PATH/peeranha.wasm $PEERANHA_PATH/peeranha_debug.cpp -I$UTILS_PATH -R$PEERANHA_PATH/rc
    eosio-cpp -abigen -o $PEERANHA_TOKEN_PATH/peeranha.tkn.wasm $PEERANHA_TOKEN_PATH/peeranha.tkn_debug.cpp -I$UTILS_PATH
else
    eosio-cpp -abigen -o $PEERANHA_PATH/peeranha.wasm $PEERANHA_PATH/peeranha.cpp -I$UTILS_PATH -R$PEERANHA_PATH/rc
    eosio-cpp -abigen -o $PEERANHA_TOKEN_PATH/peeranha.tkn.wasm $PEERANHA_TOKEN_PATH/peeranha.tkn.cpp -I$UTILS_PATH
fi

echo -e "\e[92mCompilation done! :)\e[0m"
